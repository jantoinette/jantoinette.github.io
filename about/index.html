<!DOCTYPE html>
<html lang="en">

<head>
  <link rel="icon" type="image/png" sizes="32x32" href="favicon.png">
  <link rel="stylesheet" type="text/css" href="../src/styles/style.css">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
  <meta name="description" content="⋆˙⟡ About Antoinette Chow  𓂃 ִֶ - designer in New York from Hong Kong, specializes in brand identity systems and experiences. Language lover, linguistic and visual. ⋅ॱ˙*">
  <meta name="view-transition" content="same-origin">
  <style>
    ::view-transition-old(root) {animation: none;}
    ::view-transition-new(root) {animation-name: rotate-right-down;animation-duration: 0.8s;z-index: 2;}
  </style>
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-K943JVQ707"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-K943JVQ707');

    sessionStorage.setItem('fromAbout', 'true');
  </script>
  <title>Who is Antoinette?</title>
</head>

<body id="about-page">
  <section class="about-me">
    <p><a onclick="history.back()">⤴ close</a></p>
    <div class="myInfo">
      <div id="myPic"><img src="me.jpg"></div>
      <div class="myDesc">
        <img src="text/hello.svg">
        <img src="text/nyhk.svg">
        <img src="text/realperson.svg">
      </div>
      <!-- <div class="myInfo-text">
        <h2>Hello this is me, Antoinette</h2>
        <p>I'm a New York based designer originally from Hong Kong.</p>
        <p>Language lover, linguistic and visual.</p>
        <p>A real person with strengths and flaws and a lot of ideas.</p>
      </div> -->
    </div>
    <div class="song"><iframe id="player" scrolling="no" frameborder="no" src="https://w.soundcloud.com/player/?url=https%3A//api.soundcloud.com/tracks/1246518379&color=%23ff5500&show_teaser=false&visual=true"></iframe>
      <div class="SC-text">
        <div class="play-btn">(▶︎) ‧ ˖˚ ♫ ⟡˙⋆</div>
        <div class="SC-link">
          <a href="https://frenchkiwijuice.com/" target="_blank">FKJ</a> · <a href="https://soundcloud.com/fkj-2/fkj-stay-a-child" title="Stay A Child" target="_blank">Stay A Child</a>
        </div>
      </div>
    </div>
  </section>
    
  <section class="about-content">
    <div class="note">
      <div>
        <img class="note-title" src="text/quick-facts.svg">
        <div class="note-content"><img src="text/quickfacts.svg"></div>
        <div class="dogear"></div>
      </div>
    </div>

    <div class="note">
      <div>
        <img class="note-title" src="text/identitiesandcallings.svg">
        <div class="note-content"><img src="text/ids.svg"></div>
        <div class="dogear"></div>
      </div>
    </div>

    <div class="note">
      <div>
        <img class="note-title" src="text/writing.svg">
        <div class="note-content"><img src="text/background.svg"></div>
        <div class="dogear"></div>
      </div>
    </div>

    <div class="note">
      <div>
        <img class="note-title" src="text/gerund.svg">
        <div class="note-content"><img src="text/etudiant.svg"></div>
        <div class="dogear"></div>
      </div>
    </div>

    <div class="note">
      <div>
        <img class="note-title" src="text/why-handwritten.svg">
        <div class="note-content"><img src="text/whyhandwritten.svg"></div>
        <div class="dogear"></div>
      </div>
    </div>

    <div class="note">
      <div>
        <img class="note-title" src="text/theman.svg">
        <div class="note-content jan">
          <img src="jan.jpg">
          <a href="https://www.scmp.com/lifestyle/entertainment/article/3263807/actor-designer-rapper-comedian-radio-host-jan-lamb-cantopop-duo-softhard-has-done-it-all-and-more" target="_blank"><img src="text/jan.svg"></a></p>
        </div>
        <div class="dogear"></div>
      </div>
    </div>
  </section>

  <script src="https://w.soundcloud.com/player/api.js"></script>
  <script>
    const desk = document.querySelector('.about-content');
    const notes = document.querySelectorAll('.note');
    
    let deskRect = desk.getBoundingClientRect();
    let deskWidth = deskRect.width;
    let deskHeight = deskRect.height;

    const mediaQ = window.matchMedia('(min-width:747px)');
    const isDesktop = mediaQ.matches;

    const noteSize = 240;
    const margin = 15;
    const sSpace = noteSize + margin;
    const maxOverlap = 0.3;

    function calculateOverlap(rect1, rect2) {
      const xOverlap = Math.max(0, Math.min(rect1.right, rect2.right) - Math.max(rect1.left, rect2.left));
      const yOverlap = Math.max(0, Math.min(rect1.bottom, rect2.bottom) - Math.max(rect1.top, rect2.top));
      
      const overlapArea = xOverlap * yOverlap;
      const area1 = (rect1.right - rect1.left) * (rect1.bottom - rect1.top);
      const area2 = (rect2.right - rect2.left) * (rect2.bottom - rect2.top);
      
      return overlapArea / area1;
    }

    function randomPlacement() {
      const maxX = isDesktop ? (deskWidth / 2 - sSpace) : (deskWidth - sSpace);
      const maxY = isDesktop ? (deskHeight - sSpace) : (deskHeight - 350);
      const xMath = isDesktop ? (50 * (window.innerWidth / 100)) : 0;
      const yMath = isDesktop ? 0 : 180;

      return {
        x: Math.floor(Math.random() * maxX) + xMath - 30,
        y: Math.floor(Math.random() * maxY) + yMath,
        a: Math.floor(Math.random() * 16) - 8,
      };
    }

    function checkOverlap(element, x, y) {
      const newRect = {
        left: x,
        top: y,
        right: x + noteSize,
        bottom: y + noteSize,
      };

      for (let otherElement of notes) {
        if (otherElement === element) continue;
        const otherRect = otherElement.getBoundingClientRect();

        const overlap = calculateOverlap(newRect, otherRect);

        if (overlap > maxOverlap) {
          return true;
        }
      }
      return false;
    }

    notes.forEach((note) => {
      let position = randomPlacement();
      let attempts = 0;
      const maxAttempts = 50;

      while (checkOverlap(note, position.x, position.y) && attempts < maxAttempts) {
        position = randomPlacement();
        attempts++;
      }

      note.style.transform = `translate(${position.x}px, ${position.y}px) rotate(${position.a}deg)`;
      note.style.display = 'block';
      makeDraggable(note);
    });


    function unfoldNote(event) {
      const note = event.target.closest('.note');
      const isDragging = note.dataset.isDragging === 'true';
      
      if (note) {
        event.preventDefault();
        note.classList.toggle('unfolded');
      }
    }

      
    function allowClick(el) {
      el.addEventListener('click', unfoldNote);
      el.addEventListener('touchstart', unfoldNote, { passive: false });
    };

    function stopClick(el) {
      el.removeEventListener('click', unfoldNote);
      el.removeEventListener('touchstart', unfoldNote, { passive: false });
    };

    const dogears = desk.querySelectorAll('.dogear');
    dogears.forEach((dogear) => {
      allowClick(dogear);
      dogear.addEventListener('touchmove', (e) => {
        e.preventDefault();
      }, { passive: false });
    });


    let highestZ = 0;

    function makeDraggable(element) {
      let offsetX, offsetY;
      let isDragging = false;
      let dogear = element.querySelector('.dogear');

      const startDrag = (e) => {
        e.preventDefault();
        const clientX = e.clientX || e.touches[0].clientX;
        const clientY = e.clientY || e.touches[0].clientY;
        offsetX = clientX - element.getBoundingClientRect().left;
        offsetY = clientY - element.getBoundingClientRect().top;

        const onMove = (moveEvent) => {
          isDragging = true;
          stopClick(dogear);

          const moveX = moveEvent.clientX || moveEvent.touches[0].clientX;
          const moveY = moveEvent.clientY || moveEvent.touches[0].clientY;
          let x = moveX - offsetX;
          let y = moveY - offsetY;

          x = Math.max(deskRect.left, Math.min(x, deskRect.right - element.offsetWidth));
          y = Math.max(deskRect.top, Math.min(y, deskRect.bottom - element.offsetHeight));

          let matrix = new DOMMatrix(getComputedStyle(element).transform);
          matrix.m41 = x - deskRect.left;
          matrix.m42 = y - deskRect.top;
          element.style.transform = matrix.toString();
        };

        const stopDrag = () => {
          isDragging = false;
          document.removeEventListener('mousemove', onMove);
          document.removeEventListener('mouseup', stopDrag);
          document.removeEventListener('touchmove', onMove);
          document.removeEventListener('touchend', stopDrag);

          setTimeout(() => {
            allowClick(dogear);
          }, 50);
        };

        document.addEventListener('mousemove', onMove);
        document.addEventListener('mouseup', stopDrag);
        document.addEventListener('touchmove', onMove, { passive: false });
        document.addEventListener('touchend', stopDrag);
        element.style.zIndex = ++highestZ;
      };

      element.addEventListener('mousedown', startDrag);
      element.addEventListener('touchstart', startDrag, { passive: false });
    }

    let resizeTimeout;
    function handleResize() {
      clearTimeout(resizeTimeout);
      resizeTimeout = setTimeout(() => {
        const newDeskRect = desk.getBoundingClientRect();
        const newDeskWidth = newDeskRect.width;
        const newDeskHeight = newDeskRect.height;

        notes.forEach((note) => {
          const transform = note.style.transform;
          const translateMatch = transform.match(/translate\(([^,]+)px, ([^)]+)px\)/);
          const rotateMatch = transform.match(/rotate\(([^)]+)deg\)/);

          if (translateMatch && rotateMatch) {
            const oldX = parseFloat(translateMatch[1]);
            const oldY = parseFloat(translateMatch[2]);
            const rotation = rotateMatch[1];

            const newX = (oldX / deskWidth) * newDeskWidth;
            const newY = (oldY / deskHeight) * newDeskHeight;

            note.style.transform = `translate(${newX}px, ${newY}px) rotate(${rotation}deg)`;
          }
        });

        deskWidth = newDeskWidth;
        deskHeight = newDeskHeight;
      }, 100);
    }

    window.addEventListener('resize', handleResize);


    document.addEventListener("DOMContentLoaded", function() {
      var iframe = document.getElementById('player');
      var widget = SC.Widget(iframe);

      var playButton = document.querySelector('.song .play-btn');
      var link = document.querySelector('.song .SC-link')

      playButton.addEventListener('click', function() {
        widget.toggle();
      });

      widget.bind(SC.Widget.Events.PLAY, function() {
        playButton.textContent = '(၊၊) ⊹₊˙<(ᵕᴗᵕ)> ♪ ₊˚';
        link.style.display = 'block';
      });

      widget.bind(SC.Widget.Events.PAUSE, function() {
        playButton.textContent = '(▶︎) ‧ ˖˚ ♫ ⟡˙⋆';
        link.style.display = 'none';
      });
    });

  </script>

</body>
</html>